import measStick
import motionPath
import metaLogic

typeSystem interMeasPathT =
    imports measStick, motionPath, metaLogicT
    types
    order

conSpec interMeasPath:interMeasPathT =
    imports metaLogic
    constructors
        alike : [obj,obj] -> metaBool,
        close :[formula, formula] -> metaBool,
        closeRel :[binRel, binRel] -> metaBool,
        closeOp :[terOp, terOp] -> metaBool,
        similar :[seg, obj] -> metaBool,
        equal :[binRel, binRel] -> metaBool,
        similarObj :[obj, obj] -> metaBool

tSchema similarTernary:(measStickG,motionPathG,interMeasPath) =
    source t:seg <- prefixTerOp[t0: terOp, t1:seg, t2:seg,t3:seg]
    target t':obj <- prefixTerOp[t0': terOp, t1':obj, t2':obj, t3':obj] 
    antecedent :metaTrue <-alike[t1:seg,t1':obj],
               :metaTrue <-alike[t2:seg,t2':obj],
               :metaTrue <-alike[t3:seg,t3':obj],
               :metaTrue <-closeOp[t0:terOp,t0':terOp]
    consequent :metaTrue <-similarObj[t:seg,t':obj]
    strength 1

tSchema similarBinary:(measStickG,motionPathG,interMeasPath) =
    source t:formula <- prefixBinRel[t0: binRel, t1: seg, t2: seg] 
    target t':formula <- prefixBinRel[t0': binRel, t1': obj, t2': obj]
    antecedent :metaTrue <-alike[t1:seg,t1':obj],
               :metaTrue <-alike[t2:seg,t2':obj],
               :metaTrue <-closeRel[t0:binRel,t0':binRel]
    consequent :metaTrue <-close[t:formula,t':formula]
    strength 1

tSchema rewardAllign:(measStickG,motionPathG,interMeasPath) =
    source t:formula <- logicInfixOp[f1:formula,a:and,f2:formula]
    target t':formula <- logicInfixOp[f1':formula, a':and, f2':formula]
    antecedent :metaTrue <-close[f1:formula,f1':formula],
               :metaTrue <-close[f2:formula,f2':formula]
    consequent :metaTrue <-close[t:formula,t':formula]
    strength 2

#tSchema comClose:(measStickG,motionPathG,interMeasPath) = 
#    source f:formula 
#    target f':formula 
#    antecedent :metaTrue <-close[f:formula,f':formula]
#    consequent :metaTrue <-close[f':formula, f:formula]
#    strength -1

tSchema punishMisallign:(measStickG,motionPathG,interMeasPath) =
    source t:formula <- logicInfixOp[f1:formula,a:and,f2:formula]
    target t':formula <- logicInfixOp[f1':formula,a':and, f2':formula]
    antecedent :metaTrue <-close[f1':formula,f1:formula],
               :metaFalse <-close[f2':formula,f2:formula]
    consequent :metaTrue <-close[t:formula,t':formula]
    strength -1

tSchema equivClose:(measStickG,motionPathG,interMeasPath) =
    source t:formula <- logicInfixOp[f1:formula, e:equiv ,f2:formula]
    target t':formula <- logicInfixOp[f1':formula, e:equiv , f2':formula]
    antecedent :metaTrue <-close[f1':formula,f1':formula],
               :metaTrue <-close[t:formula,t':formula]
    consequent :metaTrue <-close[f2:formula,f2':formula]
    strength 1

tSchema eqlIsClose:(measStickG,motionPathG,interMeasPath) = 
    source t:?P:binRel 
    target t':?P:binRel 
    antecedent :metaTrue <-equal[t:binRel,t':binRel]
    consequent :metaTrue <-closeRel[t:binRel,t':binRel]
    strength 1



